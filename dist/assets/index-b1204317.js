(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))P(w);new MutationObserver(w=>{for(const C of w)if(C.type==="childList")for(const X of C.addedNodes)X.tagName==="LINK"&&X.rel==="modulepreload"&&P(X)}).observe(document,{childList:!0,subtree:!0});function m(w){const C={};return w.integrity&&(C.integrity=w.integrity),w.referrerPolicy&&(C.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?C.credentials="include":w.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function P(w){if(w.ep)return;w.ep=!0;const C=m(w);fetch(w.href,C)}})();class vn{constructor(a){this.canvas=a,this.ctx=a.getContext("2d"),this.blockSize=30,this.cols=10,this.rows=20,this.board=[],this.currentPiece=null,this.currentX=0,this.currentY=0,this.score=0,this.lines=0,this.level=1,this.dropCounter=0,this.dropInterval=1e3,this.lastTime=0,this.isGameOver=!1,this.isPaused=!1,this.colors=["#000000","#00f0f0","#f0f000","#a000f0","#00f000","#f00000","#0000f0","#f0a000"],this.pieces=[[[1,1,1,1]],[[1,1],[1,1]],[[0,1,0],[1,1,1]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]]],this.init()}init(){for(let a=0;a<this.rows;a++){this.board[a]=[];for(let m=0;m<this.cols;m++)this.board[a][m]=0}}start(){this.init(),this.score=0,this.lines=0,this.level=1,this.isGameOver=!1,this.isPaused=!1,this.spawnPiece()}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.lastTime=performance.now()}spawnPiece(){const a=Math.floor(Math.random()*this.pieces.length);this.currentPiece=this.pieces[a].map(m=>[...m]);for(let m=0;m<this.currentPiece.length;m++)for(let P=0;P<this.currentPiece[m].length;P++)this.currentPiece[m][P]&&(this.currentPiece[m][P]=a+1);this.currentX=Math.floor((this.cols-this.currentPiece[0].length)/2),this.currentY=0,this.collision()&&(this.isGameOver=!0)}collision(a=0,m=0,P=this.currentPiece){for(let w=0;w<P.length;w++)for(let C=0;C<P[w].length;C++)if(P[w][C]){const X=this.currentX+C+a,M=this.currentY+w+m;if(X<0||X>=this.cols||M>=this.rows||M>=0&&this.board[M][X])return!0}return!1}merge(){for(let a=0;a<this.currentPiece.length;a++)for(let m=0;m<this.currentPiece[a].length;m++)this.currentPiece[a][m]&&(this.board[this.currentY+a][this.currentX+m]=this.currentPiece[a][m])}rotate(){const a=[],m=this.currentPiece.length;for(let P=0;P<m;P++){a[P]=[];for(let w=0;w<m;w++)a[P][w]=this.currentPiece[m-w-1][P]}this.collision(0,0,a)||(this.currentPiece=a)}moveLeft(){this.collision(-1,0)||this.currentX--}moveRight(){this.collision(1,0)||this.currentX++}softDrop(){this.collision(0,1)||(this.currentY++,this.score++)}drop(){this.collision(0,1)?(this.merge(),this.checkLines(),this.spawnPiece()):this.currentY++}checkLines(){let a=0;for(let m=this.rows-1;m>=0;m--)this.board[m].every(P=>P!==0)&&(this.board.splice(m,1),this.board.unshift(new Array(this.cols).fill(0)),a++,m++);a>0&&(this.lines+=a,this.score+=a*100*this.level,this.level=Math.floor(this.lines/10)+1,this.dropInterval=Math.max(100,1e3-(this.level-1)*100))}update(){if(this.isPaused||this.isGameOver)return;const a=performance.now(),m=a-this.lastTime;this.lastTime=a,this.dropCounter+=m,this.dropCounter>this.dropInterval&&(this.drop(),this.dropCounter=0)}render(){this.ctx.fillStyle="#222",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="#444",this.ctx.lineWidth=1;for(let a=0;a<=this.rows;a++)this.ctx.beginPath(),this.ctx.moveTo(0,a*this.blockSize),this.ctx.lineTo(this.cols*this.blockSize,a*this.blockSize),this.ctx.stroke();for(let a=0;a<=this.cols;a++)this.ctx.beginPath(),this.ctx.moveTo(a*this.blockSize,0),this.ctx.lineTo(a*this.blockSize,this.rows*this.blockSize),this.ctx.stroke();for(let a=0;a<this.rows;a++)for(let m=0;m<this.cols;m++)this.board[a][m]&&this.drawBlock(m,a,this.colors[this.board[a][m]]);if(this.currentPiece)for(let a=0;a<this.currentPiece.length;a++)for(let m=0;m<this.currentPiece[a].length;m++)this.currentPiece[a][m]&&this.drawBlock(this.currentX+m,this.currentY+a,this.colors[this.currentPiece[a][m]]);this.isGameOver&&(this.ctx.fillStyle="rgba(0, 0, 0, 0.7)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="white",this.ctx.font="30px Arial",this.ctx.textAlign="center",this.ctx.fillText("GAME OVER",this.canvas.width/2,this.canvas.height/2))}drawBlock(a,m,P){this.ctx.fillStyle=P,this.ctx.fillRect(a*this.blockSize,m*this.blockSize,this.blockSize-2,this.blockSize-2),this.ctx.fillStyle="rgba(255, 255, 255, 0.3)",this.ctx.fillRect(a*this.blockSize,m*this.blockSize,this.blockSize-2,4)}}var yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ar={};(function(){var G;function a(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}var m=typeof Object.defineProperties=="function"?Object.defineProperty:function(t,e,r){return t==Array.prototype||t==Object.prototype||(t[e]=r.value),t};function P(t){t=[typeof globalThis=="object"&&globalThis,t,typeof window=="object"&&window,typeof self=="object"&&self,typeof yt=="object"&&yt];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}var w=P(this);function C(t,e){if(e)t:{var r=w;t=t.split(".");for(var n=0;n<t.length-1;n++){var i=t[n];if(!(i in r))break t;r=r[i]}t=t[t.length-1],n=r[t],e=e(n),e!=n&&e!=null&&m(r,t,{configurable:!0,writable:!0,value:e})}}C("Symbol",function(t){function e(s){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new r(n+(s||"")+"_"+i++,s)}function r(s,o){this.h=s,m(this,"description",{configurable:!0,writable:!0,value:o})}if(t)return t;r.prototype.toString=function(){return this.h};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return e}),C("Symbol.iterator",function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var e="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<e.length;r++){var n=w[e[r]];typeof n=="function"&&typeof n.prototype[t]!="function"&&m(n.prototype,t,{configurable:!0,writable:!0,value:function(){return X(a(this))}})}return t});function X(t){return t={next:t},t[Symbol.iterator]=function(){return this},t}function M(t){var e=typeof Symbol<"u"&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:a(t)}}function mt(t){if(!(t instanceof Array)){t=M(t);for(var e,r=[];!(e=t.next()).done;)r.push(e.value);t=r}return t}var nt=typeof Object.assign=="function"?Object.assign:function(t,e){for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};C("Object.assign",function(t){return t||nt});var jt=typeof Object.create=="function"?Object.create:function(t){function e(){}return e.prototype=t,new e},ft;if(typeof Object.setPrototypeOf=="function")ft=Object.setPrototypeOf;else{var V;t:{var ut={a:!0},f={};try{f.__proto__=ut,V=f.a;break t}catch{}V=!1}ft=V?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var x=ft;function g(t,e){if(t.prototype=jt(e.prototype),t.prototype.constructor=t,x)x(t,e);else for(var r in e)if(r!="prototype")if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(e,r);n&&Object.defineProperty(t,r,n)}else t[r]=e[r];t.ya=e.prototype}function A(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function U(t){if(t.m)throw new TypeError("Generator is already running");t.m=!0}A.prototype.u=function(t){this.i=t};function B(t,e){t.l={ma:e,na:!0},t.h=t.s||t.v}A.prototype.return=function(t){this.l={return:t},this.h=this.v};function F(t,e,r){return t.h=r,{value:e}}function Q(t){this.h=new A,this.i=t}function Qt(t,e){U(t.h);var r=t.h.j;return r?pt(t,"return"in r?r.return:function(n){return{value:n,done:!0}},e,t.h.return):(t.h.return(e),$(t))}function pt(t,e,r,n){try{var i=e.call(t.h.j,r);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return t.h.m=!1,i;var s=i.value}catch(o){return t.h.j=null,B(t.h,o),$(t)}return t.h.j=null,n.call(t.h,s),$(t)}function $(t){for(;t.h.h;)try{var e=t.i(t.h);if(e)return t.h.m=!1,{value:e.value,done:!1}}catch(r){t.h.i=void 0,B(t.h,r)}if(t.h.m=!1,t.h.l){if(e=t.h.l,t.h.l=null,e.na)throw e.ma;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function vt(t){this.next=function(e){return U(t.h),t.h.j?e=pt(t,t.h.j.next,e,t.h.u):(t.h.u(e),e=$(t)),e},this.throw=function(e){return U(t.h),t.h.j?e=pt(t,t.h.j.throw,e,t.h.u):(B(t.h,e),e=$(t)),e},this.return=function(e){return Qt(t,e)},this[Symbol.iterator]=function(){return this}}function h(t){function e(n){return t.next(n)}function r(n){return t.throw(n)}return new Promise(function(n,i){function s(o){o.done?n(o.value):Promise.resolve(o.value).then(e,r).then(s,i)}s(t.next())})}function c(t){return h(new vt(new Q(t)))}C("Promise",function(t){function e(o){this.i=0,this.j=void 0,this.h=[],this.u=!1;var u=this.l();try{o(u.resolve,u.reject)}catch(l){u.reject(l)}}function r(){this.h=null}function n(o){return o instanceof e?o:new e(function(u){u(o)})}if(t)return t;r.prototype.i=function(o){if(this.h==null){this.h=[];var u=this;this.j(function(){u.m()})}this.h.push(o)};var i=w.setTimeout;r.prototype.j=function(o){i(o,0)},r.prototype.m=function(){for(;this.h&&this.h.length;){var o=this.h;this.h=[];for(var u=0;u<o.length;++u){var l=o[u];o[u]=null;try{l()}catch(p){this.l(p)}}}this.h=null},r.prototype.l=function(o){this.j(function(){throw o})},e.prototype.l=function(){function o(p){return function(d){l||(l=!0,p.call(u,d))}}var u=this,l=!1;return{resolve:o(this.I),reject:o(this.m)}},e.prototype.I=function(o){if(o===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(o instanceof e)this.L(o);else{t:switch(typeof o){case"object":var u=o!=null;break t;case"function":u=!0;break t;default:u=!1}u?this.F(o):this.s(o)}},e.prototype.F=function(o){var u=void 0;try{u=o.then}catch(l){this.m(l);return}typeof u=="function"?this.M(u,o):this.s(o)},e.prototype.m=function(o){this.v(2,o)},e.prototype.s=function(o){this.v(1,o)},e.prototype.v=function(o,u){if(this.i!=0)throw Error("Cannot settle("+o+", "+u+"): Promise already settled in state"+this.i);this.i=o,this.j=u,this.i===2&&this.K(),this.H()},e.prototype.K=function(){var o=this;i(function(){if(o.D()){var u=w.console;typeof u<"u"&&u.error(o.j)}},1)},e.prototype.D=function(){if(this.u)return!1;var o=w.CustomEvent,u=w.Event,l=w.dispatchEvent;return typeof l>"u"?!0:(typeof o=="function"?o=new o("unhandledrejection",{cancelable:!0}):typeof u=="function"?o=new u("unhandledrejection",{cancelable:!0}):(o=w.document.createEvent("CustomEvent"),o.initCustomEvent("unhandledrejection",!1,!0,o)),o.promise=this,o.reason=this.j,l(o))},e.prototype.H=function(){if(this.h!=null){for(var o=0;o<this.h.length;++o)s.i(this.h[o]);this.h=null}};var s=new r;return e.prototype.L=function(o){var u=this.l();o.T(u.resolve,u.reject)},e.prototype.M=function(o,u){var l=this.l();try{o.call(u,l.resolve,l.reject)}catch(p){l.reject(p)}},e.prototype.then=function(o,u){function l(b,y){return typeof b=="function"?function(S){try{p(b(S))}catch(_){d(_)}}:y}var p,d,E=new e(function(b,y){p=b,d=y});return this.T(l(o,p),l(u,d)),E},e.prototype.catch=function(o){return this.then(void 0,o)},e.prototype.T=function(o,u){function l(){switch(p.i){case 1:o(p.j);break;case 2:u(p.j);break;default:throw Error("Unexpected state: "+p.i)}}var p=this;this.h==null?s.i(l):this.h.push(l),this.u=!0},e.resolve=n,e.reject=function(o){return new e(function(u,l){l(o)})},e.race=function(o){return new e(function(u,l){for(var p=M(o),d=p.next();!d.done;d=p.next())n(d.value).T(u,l)})},e.all=function(o){var u=M(o),l=u.next();return l.done?n([]):new e(function(p,d){function E(S){return function(_){b[S]=_,y--,y==0&&p(b)}}var b=[],y=0;do b.push(void 0),y++,n(l.value).T(E(b.length-1),d),l=u.next();while(!l.done)})},e});function T(t,e){t instanceof String&&(t+="");var r=0,n=!1,i={next:function(){if(!n&&r<t.length){var s=r++;return{value:e(s,t[s]),done:!1}}return n=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}C("Array.prototype.keys",function(t){return t||function(){return T(this,function(e){return e})}}),C("Array.prototype.fill",function(t){return t||function(e,r,n){var i=this.length||0;for(0>r&&(r=Math.max(0,i+r)),(n==null||n>i)&&(n=i),n=Number(n),0>n&&(n=Math.max(0,i+n)),r=Number(r||0);r<n;r++)this[r]=e;return this}});function j(t){return t||Array.prototype.fill}C("Int8Array.prototype.fill",j),C("Uint8Array.prototype.fill",j),C("Uint8ClampedArray.prototype.fill",j),C("Int16Array.prototype.fill",j),C("Uint16Array.prototype.fill",j),C("Int32Array.prototype.fill",j),C("Uint32Array.prototype.fill",j),C("Float32Array.prototype.fill",j),C("Float64Array.prototype.fill",j),C("Object.is",function(t){return t||function(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}}),C("Array.prototype.includes",function(t){return t||function(e,r){var n=this;n instanceof String&&(n=String(n));var i=n.length;for(r=r||0,0>r&&(r=Math.max(r+i,0));r<i;r++){var s=n[r];if(s===e||Object.is(s,e))return!0}return!1}}),C("String.prototype.includes",function(t){return t||function(e,r){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(e,r||0)!==-1}});var L=this||self;function H(t,e){t=t.split(".");var r=L;t[0]in r||typeof r.execScript>"u"||r.execScript("var "+t[0]);for(var n;t.length&&(n=t.shift());)t.length||e===void 0?r[n]&&r[n]!==Object.prototype[n]?r=r[n]:r=r[n]={}:r[n]=e}function v(t){var e;t:{if((e=L.navigator)&&(e=e.userAgent))break t;e=""}return e.indexOf(t)!=-1}var O=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var r=t.length,n=Array(r),i=typeof t=="string"?t.split(""):t,s=0;s<r;s++)s in i&&(n[s]=e.call(void 0,i[s],s,t));return n},k={},N=null;function tt(t){var e=t.length,r=3*e/4;r%3?r=Math.floor(r):"=.".indexOf(t[e-1])!=-1&&(r="=.".indexOf(t[e-2])!=-1?r-2:r-1);var n=new Uint8Array(r),i=0;return Ct(t,function(s){n[i++]=s}),i!==r?n.subarray(0,i):n}function Ct(t,e){function r(l){for(;n<t.length;){var p=t.charAt(n++),d=N[p];if(d!=null)return d;if(!/^[\s\xa0]*$/.test(p))throw Error("Unknown base64 encoding at char: "+p)}return l}et();for(var n=0;;){var i=r(-1),s=r(0),o=r(64),u=r(64);if(u===64&&i===-1)break;e(i<<2|s>>4),o!=64&&(e(s<<4&240|o>>2),u!=64&&e(o<<6&192|u))}}function et(){if(!N){N={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],r=0;5>r;r++){var n=t.concat(e[r].split(""));k[r]=n;for(var i=0;i<n.length;i++){var s=n[i];N[s]===void 0&&(N[s]=i)}}}}var it=typeof Uint8Array<"u",Ot=!(v("Trident")||v("MSIE"))&&typeof L.btoa=="function";function Et(t){if(!Ot){var e;e===void 0&&(e=0),et(),e=k[e];for(var r=Array(Math.floor(t.length/3)),n=e[64]||"",i=0,s=0;i<t.length-2;i+=3){var o=t[i],u=t[i+1],l=t[i+2],p=e[o>>2];o=e[(o&3)<<4|u>>4],u=e[(u&15)<<2|l>>6],l=e[l&63],r[s++]=p+o+u+l}switch(p=0,l=n,t.length-i){case 2:p=t[i+1],l=e[(p&15)<<2]||n;case 1:t=t[i],r[s]=e[t>>2]+e[(t&3)<<4|p>>4]+l+n}return r.join("")}for(e="";10240<t.length;)e+=String.fromCharCode.apply(null,t.subarray(0,10240)),t=t.subarray(10240);return e+=String.fromCharCode.apply(null,t),btoa(e)}var we=RegExp("[-_.]","g");function jr(t){switch(t){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function xe(t){if(!Ot)return tt(t);we.test(t)&&(t=t.replace(we,jr)),t=atob(t);for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}var Ae;function Jt(){return Ae||(Ae=new Uint8Array(0))}var Ft={},Or=typeof Uint8Array.prototype.slice=="function",W=0,Z=0;function be(t){var e=0>t;t=Math.abs(t);var r=t>>>0;t=Math.floor((t-r)/4294967296),e&&(r=M(je(r,t)),e=r.next().value,t=r.next().value,r=e),W=r>>>0,Z=t>>>0}var Er=typeof BigInt=="function";function je(t,e){return e=~e,t?t=~t+1:e+=1,[t,e]}function Oe(t,e){this.i=t>>>0,this.h=e>>>0}function Ee(t){if(!t)return Se||(Se=new Oe(0,0));if(!/^-?\d+$/.test(t))return null;if(16>t.length)be(Number(t));else if(Er)t=BigInt(t),W=Number(t&BigInt(4294967295))>>>0,Z=Number(t>>BigInt(32)&BigInt(4294967295));else{var e=+(t[0]==="-");Z=W=0;for(var r=t.length,n=e,i=(r-e)%6+e;i<=r;n=i,i+=6)n=Number(t.slice(n,i)),Z*=1e6,W=1e6*W+n,4294967296<=W&&(Z+=W/4294967296|0,W%=4294967296);e&&(e=M(je(W,Z)),t=e.next().value,e=e.next().value,W=t,Z=e)}return new Oe(W,Z)}var Se;function Pe(t,e){return Error("Invalid wire type: "+t+" (at position "+e+")")}function qt(){return Error("Failed to read varint, encoding is invalid.")}function Te(t,e){return Error("Tried to read past the end of the data "+e+" > "+t)}function wt(){throw Error("Invalid UTF8")}function Ce(t,e){return e=String.fromCharCode.apply(null,e),t==null?e:t+e}var It=void 0,te,Sr=typeof TextDecoder<"u",Fe,Pr=typeof TextEncoder<"u",_e;function Me(t){if(t!==Ft)throw Error("illegal external caller")}function _t(t,e){if(Me(e),this.V=t,t!=null&&t.length===0)throw Error("ByteString should be constructed with non-empty values")}function ee(){return _e||(_e=new _t(null,Ft))}function ke(t){Me(Ft);var e=t.V;return e=e==null||it&&e!=null&&e instanceof Uint8Array?e:typeof e=="string"?xe(e):null,e==null?e:t.V=e}function Tr(t){if(typeof t=="string")return{buffer:xe(t),C:!1};if(Array.isArray(t))return{buffer:new Uint8Array(t),C:!1};if(t.constructor===Uint8Array)return{buffer:t,C:!1};if(t.constructor===ArrayBuffer)return{buffer:new Uint8Array(t),C:!1};if(t.constructor===_t)return{buffer:ke(t)||Jt(),C:!0};if(t instanceof Uint8Array)return{buffer:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Re(t,e){this.i=null,this.m=!1,this.h=this.j=this.l=0,re(this,t,e)}function re(t,e,r){r=r===void 0?{}:r,t.S=r.S===void 0?!1:r.S,e&&(e=Tr(e),t.i=e.buffer,t.m=e.C,t.l=0,t.j=t.i.length,t.h=t.l)}Re.prototype.reset=function(){this.h=this.l};function xt(t,e){if(t.h=e,e>t.j)throw Te(t.j,e)}function Mt(t){var e=t.i,r=t.h,n=e[r++],i=n&127;if(n&128&&(n=e[r++],i|=(n&127)<<7,n&128&&(n=e[r++],i|=(n&127)<<14,n&128&&(n=e[r++],i|=(n&127)<<21,n&128&&(n=e[r++],i|=n<<28,n&128&&e[r++]&128&&e[r++]&128&&e[r++]&128&&e[r++]&128&&e[r++]&128)))))throw qt();return xt(t,r),i}function Ue(t,e){if(0>e)throw Error("Tried to read a negative byte length: "+e);var r=t.h,n=r+e;if(n>t.j)throw Te(e,t.j-r);return t.h=n,r}var Le=[];function ne(){this.h=[]}ne.prototype.length=function(){return this.h.length},ne.prototype.end=function(){var t=this.h;return this.h=[],t};function Be(t,e,r){for(;0<r||127<e;)t.h.push(e&127|128),e=(e>>>7|r<<25)>>>0,r>>>=7;t.h.push(e)}function At(t,e){for(;127<e;)t.h.push(e&127|128),e>>>=7;t.h.push(e)}function ie(t,e){if(Le.length){var r=Le.pop();re(r,t,e),t=r}else t=new Re(t,e);this.h=t,this.j=this.h.h,this.i=this.l=-1,this.setOptions(e)}ie.prototype.setOptions=function(t){t=t===void 0?{}:t,this.ca=t.ca===void 0?!1:t.ca},ie.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Ie(t){var e=t.h;if(e.h==e.j)return!1;t.j=t.h.h;var r=Mt(t.h)>>>0;if(e=r>>>3,r&=7,!(0<=r&&5>=r))throw Pe(r,t.j);if(1>e)throw Error("Invalid field number: "+e+" (at position "+t.j+")");return t.l=e,t.i=r,!0}function Gt(t){switch(t.i){case 0:if(t.i!=0)Gt(t);else t:{t=t.h;for(var e=t.h,r=e+10,n=t.i;e<r;)if(!(n[e++]&128)){xt(t,e);break t}throw qt()}break;case 1:t=t.h,xt(t,t.h+8);break;case 2:t.i!=2?Gt(t):(e=Mt(t.h)>>>0,t=t.h,xt(t,t.h+e));break;case 5:t=t.h,xt(t,t.h+4);break;case 3:e=t.l;do{if(!Ie(t))throw Error("Unmatched start-group tag: stream EOF");if(t.i==4){if(t.l!=e)throw Error("Unmatched end-group tag");break}Gt(t)}while(1);break;default:throw Pe(t.i,t.j)}}var Nt=[];function Cr(){this.j=[],this.i=0,this.h=new ne}function St(t,e){e.length!==0&&(t.j.push(e),t.i+=e.length)}function Fr(t,e){if(e=e.R){St(t,t.h.end());for(var r=0;r<e.length;r++)St(t,ke(e[r])||Jt())}}var dt=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function bt(t,e){return dt?t[dt]|=e:t.A!==void 0?t.A|=e:(Object.defineProperties(t,{A:{value:e,configurable:!0,writable:!0,enumerable:!1}}),e)}function Ge(t,e){dt?t[dt]&&(t[dt]&=~e):t.A!==void 0&&(t.A&=~e)}function z(t){var e;return dt?e=t[dt]:e=t.A,e??0}function lt(t,e){dt?t[dt]=e:t.A!==void 0?t.A=e:Object.defineProperties(t,{A:{value:e,configurable:!0,writable:!0,enumerable:!1}})}function oe(t){return bt(t,1),t}function _r(t,e){lt(e,(t|0)&-51)}function Dt(t,e){lt(e,(t|18)&-41)}var se={};function zt(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)&&t.constructor===Object}var kt,Ne=[];lt(Ne,23),kt=Object.freeze(Ne);function ue(t){if(z(t.o)&2)throw Error("Cannot mutate an immutable Message")}function le(t){var e=t.length;(e=e?t[e-1]:void 0)&&zt(e)?e.g=1:(e={},t.push((e.g=1,e)))}function De(t){var e=t.i+t.G;return t.B||(t.B=t.o[e]={})}function ot(t,e){return e===-1?null:e>=t.i?t.B?t.B[e]:void 0:t.o[e+t.G]}function ht(t,e,r,n){ue(t),Rt(t,e,r,n)}function Rt(t,e,r,n){t.j&&(t.j=void 0),e>=t.i||n?De(t)[e]=r:(t.o[e+t.G]=r,(t=t.B)&&e in t&&delete t[e])}function he(t,e,r,n){var i=ot(t,e);Array.isArray(i)||(i=kt);var s=z(i);if(s&1||oe(i),n)s&2||bt(i,2),r&1||Object.freeze(i);else{n=!(r&2);var o=s&2;r&1||!o?n&&s&16&&!o&&Ge(i,16):(i=oe(Array.prototype.slice.call(i)),Rt(t,e,i))}return i}function ce(t,e){var r=ot(t,e),n=r==null?r:typeof r=="number"||r==="NaN"||r==="Infinity"||r==="-Infinity"?Number(r):void 0;return n!=null&&n!==r&&Rt(t,e,n),n}function ze(t,e,r,n,i){t.h||(t.h={});var s=t.h[r],o=he(t,r,3,i);if(!s){var u=o;s=[];var l=!!(z(t.o)&16);o=!!(z(u)&2);var p=u;!i&&o&&(u=Array.prototype.slice.call(u));for(var d=o,E=0;E<u.length;E++){var b=u[E],y=e,S=!1;if(S=S===void 0?!1:S,b=Array.isArray(b)?new y(b):S?new y:void 0,b!==void 0){y=b.o;var _=S=z(y);o&&(_|=2),l&&(_|=16),_!=S&&lt(y,_),y=_,d=d||!!(2&y),s.push(b)}}return t.h[r]=s,l=z(u),e=l|33,e=d?e&-9:e|8,l!=e&&(d=u,Object.isFrozen(d)&&(d=Array.prototype.slice.call(d)),lt(d,e),u=d),p!==u&&Rt(t,r,u),(i||n&&o)&&bt(s,2),n&&Object.freeze(s),s}return i||(i=Object.isFrozen(s),n&&!i?Object.freeze(s):!n&&i&&(s=Array.prototype.slice.call(s),t.h[r]=s)),s}function Ht(t,e,r){var n=!!(z(t.o)&2);if(e=ze(t,e,r,n,n),t=he(t,r,3,n),!(n||z(t)&8)){for(n=0;n<e.length;n++){if(r=e[n],z(r.o)&2){var i=Ke(r,!1);i.j=r}else i=r;r!==i&&(e[n]=i,t[n]=i.o)}bt(t,8)}return e}function ct(t,e,r){if(r!=null&&typeof r!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof r+": "+r);ht(t,e,r)}function He(t,e,r,n,i){ue(t);var s=ze(t,r,e,!1,!1);return r=n??new r,t=he(t,e,2,!1),i!=null?(s.splice(i,0,r),t.splice(i,0,r.o)):(s.push(r),t.push(r.o)),r.C()&&Ge(t,8),r}function Wt(t,e){return t??e}function at(t,e,r){return r=r===void 0?0:r,Wt(ce(t,e),r)}var Xt;function Mr(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"object":if(t)if(Array.isArray(t)){if(z(t)&128)return t=Array.prototype.slice.call(t),le(t),t}else{if(it&&t!=null&&t instanceof Uint8Array)return Et(t);if(t instanceof _t){var e=t.V;return e==null?"":typeof e=="string"?e:t.V=Et(e)}}}return t}function We(t,e,r,n){if(t!=null){if(Array.isArray(t))t=ae(t,e,r,n!==void 0);else if(zt(t)){var i={},s;for(s in t)i[s]=We(t[s],e,r,n);t=i}else t=e(t,n);return t}}function ae(t,e,r,n){var i=z(t);n=n?!!(i&16):void 0,t=Array.prototype.slice.call(t);for(var s=0;s<t.length;s++)t[s]=We(t[s],e,r,n);return r(i,t),t}function kr(t){return t.ja===se?t.toJSON():Mr(t)}function Rr(t,e){t&128&&le(e)}function Xe(t,e,r){if(r=r===void 0?Dt:r,t!=null){if(it&&t instanceof Uint8Array)return t.length?new _t(new Uint8Array(t),Ft):ee();if(Array.isArray(t)){var n=z(t);return n&2?t:e&&!(n&32)&&(n&16||n===0)?(lt(t,n|2),t):(t=ae(t,Xe,n&4?Dt:r,!0),e=z(t),e&4&&e&2&&Object.freeze(t),t)}return t.ja===se?Ye(t):t}}function Ve(t,e,r,n,i,s,o){if(t=t.h&&t.h[r]){if(n=z(t),n&2?n=t:(s=O(t,Ye),Dt(n,s),Object.freeze(s),n=s),ue(e),o=n==null?kt:oe([]),n!=null){for(s=!!n.length,t=0;t<n.length;t++){var u=n[t];s=s&&!(z(u.o)&2),o[t]=u.o}s=(s?8:0)|1,t=z(o),(t&s)!==s&&(Object.isFrozen(o)&&(o=Array.prototype.slice.call(o)),lt(o,t|s)),e.h||(e.h={}),e.h[r]=n}else e.h&&(e.h[r]=void 0);Rt(e,r,o,i)}else ht(e,r,Xe(n,s,o),i)}function Ye(t){return z(t.o)&2||(t=Ke(t,!0),bt(t.o,2)),t}function Ke(t,e){var r=t.o,n=[];bt(n,16);var i=t.constructor.h;if(i&&n.push(i),i=t.B,i){n.length=r.length,n.fill(void 0,n.length,r.length);var s={};n[n.length-1]=s}z(r)&128&&le(n),e=e||t.C()?Dt:_r,s=t.constructor,Xt=n,n=new s(n),Xt=void 0,t.R&&(n.R=t.R.slice()),s=!!(z(r)&16);for(var o=i?r.length-1:r.length,u=0;u<o;u++)Ve(t,n,u-t.G,r[u],!1,s,e);if(i)for(var l in i)Ve(t,n,+l,i[l],!0,s,e);return n}function J(t,e,r){t==null&&(t=Xt),Xt=void 0;var n=this.constructor.i||0,i=0<n,s=this.constructor.h,o=!1;if(t==null){t=s?[s]:[];var u=48,l=!0;i&&(n=0,u|=128),lt(t,u)}else{if(!Array.isArray(t)||s&&s!==t[0])throw Error();var p=u=bt(t,0);if((l=(16&p)!==0)&&((o=(32&p)!==0)||(p|=32)),i){if(128&p)n=0;else if(0<t.length){var d=t[t.length-1];if(zt(d)&&"g"in d){n=0,p|=128,delete d.g;var E=!0,b;for(b in d){E=!1;break}E&&t.pop()}}}else if(128&p)throw Error();u!==p&&lt(t,p)}this.G=(s?0:-1)-n,this.h=void 0,this.o=t;t:{if(s=this.o.length,n=s-1,s&&(s=this.o[n],zt(s))){this.B=s,this.i=n-this.G;break t}e!==void 0&&-1<e?(this.i=Math.max(e,n+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!i&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(r){e=l&&!o&&!0,i=this.i;var y;for(l=0;l<r.length;l++)o=r[l],o<i?(o+=this.G,(n=t[o])?$e(n,e):t[o]=kt):(y||(y=De(this)),(n=y[o])?$e(n,e):y[o]=kt)}}J.prototype.toJSON=function(){return ae(this.o,kr,Rr)},J.prototype.C=function(){return!!(z(this.o)&2)};function $e(t,e){if(Array.isArray(t)){var r=z(t),n=1;!e||r&2||(n|=16),(r&n)!==n&&lt(t,r|n)}}J.prototype.ja=se,J.prototype.toString=function(){return this.o.toString()};function Ze(t,e,r){if(r){var n={},i;for(i in r){var s=r[i],o=s.qa;o||(n.J=s.wa||s.oa.W,s.ia?(n.aa=er(s.ia),o=function(u){return function(l,p,d){return u.J(l,p,d,u.aa)}}(n)):s.ka?(n.Z=rr(s.da.P,s.ka),o=function(u){return function(l,p,d){return u.J(l,p,d,u.Z)}}(n)):o=n.J,s.qa=o),o(e,t,s.da),n={J:n.J,aa:n.aa,Z:n.Z}}}Fr(e,t)}var Vt=Symbol();function Qe(t,e,r){return t[Vt]||(t[Vt]=function(n,i){return e(n,i,r)})}function Je(t){var e=t[Vt];if(!e){var r=pe(t);e=function(n,i){return nr(n,i,r)},t[Vt]=e}return e}function Ur(t){var e=t.ia;if(e)return Je(e);if(e=t.va)return Qe(t.da.P,e,t.ka)}function Lr(t){var e=Ur(t),r=t.da,n=t.oa.U;return e?function(i,s){return n(i,s,r,e)}:function(i,s){return n(i,s,r)}}function qe(t,e){var r=t[e];return typeof r=="function"&&r.length===0&&(r=r(),t[e]=r),Array.isArray(r)&&(Lt in r||Ut in r||0<r.length&&typeof r[0]=="function")?r:void 0}function tr(t,e,r,n,i,s){e.P=t[0];var o=1;if(t.length>o&&typeof t[o]!="number"){var u=t[o++];r(e,u)}for(;o<t.length;){r=t[o++];for(var l=o+1;l<t.length&&typeof t[l]!="number";)l++;switch(u=t[o++],l-=o,l){case 0:n(e,r,u);break;case 1:(l=qe(t,o))?(o++,i(e,r,u,l)):n(e,r,u,t[o++]);break;case 2:l=o++,l=qe(t,l),i(e,r,u,l,t[o++]);break;case 3:s(e,r,u,t[o++],t[o++],t[o++]);break;case 4:s(e,r,u,t[o++],t[o++],t[o++],t[o++]);break;default:throw Error("unexpected number of binary field arguments: "+l)}}return e}var Yt=Symbol();function er(t){var e=t[Yt];if(!e){var r=fe(t);e=function(n,i){return ir(n,i,r)},t[Yt]=e}return e}function rr(t,e){var r=t[Yt];return r||(r=function(n,i){return Ze(n,i,e)},t[Yt]=r),r}var Ut=Symbol();function Br(t,e){t.push(e)}function Ir(t,e,r){t.push(e,r.W)}function Gr(t,e,r,n){var i=er(n),s=fe(n).P,o=r.W;t.push(e,function(u,l,p){return o(u,l,p,s,i)})}function Nr(t,e,r,n,i,s){var o=rr(n,s),u=r.W;t.push(e,function(l,p,d){return u(l,p,d,n,o)})}function fe(t){var e=t[Ut];return e||(e=tr(t,t[Ut]=[],Br,Ir,Gr,Nr),Lt in t&&Ut in t&&(t.length=0),e)}var Lt=Symbol();function Dr(t,e){t[0]=e}function zr(t,e,r,n){var i=r.U;t[e]=n?function(s,o,u){return i(s,o,u,n)}:i}function Hr(t,e,r,n,i){var s=r.U,o=Je(n),u=pe(n).P;t[e]=function(l,p,d){return s(l,p,d,u,o,i)}}function Wr(t,e,r,n,i,s,o){var u=r.U,l=Qe(n,i,s);t[e]=function(p,d,E){return u(p,d,E,n,l,o)}}function pe(t){var e=t[Lt];return e||(e=tr(t,t[Lt]={},Dr,zr,Hr,Wr),Lt in t&&Ut in t&&(t.length=0),e)}function nr(t,e,r){for(;Ie(e)&&e.i!=4;){var n=e.l,i=r[n];if(!i){var s=r[0];s&&(s=s[n])&&(i=r[n]=Lr(s))}if(!i||!i(e,t,n)){i=e,n=t,s=i.j,Gt(i);var o=i;if(!o.ca){if(i=o.h.h-s,o.h.h=s,o=o.h,i==0)i=ee();else{if(s=Ue(o,i),o.S&&o.m)i=o.i.subarray(s,s+i);else{o=o.i;var u=s;i=s+i,i=u===i?Jt():Or?o.slice(u,i):new Uint8Array(o.subarray(u,i))}i=i.length==0?ee():new _t(i,Ft)}(s=n.R)?s.push(i):n.R=[i]}}}return t}function ir(t,e,r){for(var n=r.length,i=n%2==1,s=i?1:0;s<n;s+=2)(0,r[s+1])(e,t,r[s]);Ze(t,e,i?r[0]:void 0)}function Bt(t,e){return{U:t,W:e}}var st=Bt(function(t,e,r){if(t.i!==5)return!1;t=t.h;var n=t.i,i=t.h,s=n[i],o=n[i+1],u=n[i+2];return n=n[i+3],xt(t,t.h+4),o=(s<<0|o<<8|u<<16|n<<24)>>>0,t=2*(o>>31)+1,s=o>>>23&255,o&=8388607,ht(e,r,s==255?o?NaN:1/0*t:s==0?t*Math.pow(2,-149)*o:t*Math.pow(2,s-150)*(o+Math.pow(2,23))),!0},function(t,e,r){if(e=ce(e,r),e!=null){At(t.h,8*r+5),t=t.h;var n=+e;n===0?0<1/n?W=Z=0:(Z=0,W=2147483648):isNaN(n)?(Z=0,W=2147483647):(n=(r=0>n?-2147483648:0)?-n:n,34028234663852886e22<n?(Z=0,W=(r|2139095040)>>>0):11754943508222875e-54>n?(n=Math.round(n/Math.pow(2,-149)),Z=0,W=(r|n)>>>0):(e=Math.floor(Math.log(n)/Math.LN2),n*=Math.pow(2,-e),n=Math.round(8388608*n),16777216<=n&&++e,Z=0,W=(r|e+127<<23|n&8388607)>>>0)),r=W,t.h.push(r>>>0&255),t.h.push(r>>>8&255),t.h.push(r>>>16&255),t.h.push(r>>>24&255)}}),Xr=Bt(function(t,e,r){if(t.i!==0)return!1;var n=t.h,i=0,s=t=0,o=n.i,u=n.h;do{var l=o[u++];i|=(l&127)<<s,s+=7}while(32>s&&l&128);for(32<s&&(t|=(l&127)>>4),s=3;32>s&&l&128;s+=7)l=o[u++],t|=(l&127)<<s;if(xt(n,u),128>l)n=i>>>0,l=t>>>0,(t=l&2147483648)&&(n=~n+1>>>0,l=~l>>>0,n==0&&(l=l+1>>>0)),n=4294967296*l+(n>>>0);else throw qt();return ht(e,r,t?-n:n),!0},function(t,e,r){e=ot(e,r),e!=null&&(typeof e=="string"&&Ee(e),e!=null&&(At(t.h,8*r),typeof e=="number"?(t=t.h,be(e),Be(t,W,Z)):(r=Ee(e),Be(t.h,r.i,r.h))))}),Vr=Bt(function(t,e,r){return t.i!==0?!1:(ht(e,r,Mt(t.h)),!0)},function(t,e,r){if(e=ot(e,r),e!=null&&e!=null)if(At(t.h,8*r),t=t.h,r=e,0<=r)At(t,r);else{for(e=0;9>e;e++)t.h.push(r&127|128),r>>=7;t.h.push(1)}}),or=Bt(function(t,e,r){if(t.i!==2)return!1;var n=Mt(t.h)>>>0;t=t.h;var i=Ue(t,n);if(t=t.i,Sr){var s=t,o;(o=te)||(o=te=new TextDecoder("utf-8",{fatal:!0})),t=i+n,s=i===0&&t===s.length?s:s.subarray(i,t);try{var u=o.decode(s)}catch(E){if(It===void 0){try{o.decode(new Uint8Array([128]))}catch{}try{o.decode(new Uint8Array([97])),It=!0}catch{It=!1}}throw!It&&(te=void 0),E}}else{u=i,n=u+n,i=[];for(var l=null,p,d;u<n;)p=t[u++],128>p?i.push(p):224>p?u>=n?wt():(d=t[u++],194>p||(d&192)!==128?(u--,wt()):i.push((p&31)<<6|d&63)):240>p?u>=n-1?wt():(d=t[u++],(d&192)!==128||p===224&&160>d||p===237&&160<=d||((s=t[u++])&192)!==128?(u--,wt()):i.push((p&15)<<12|(d&63)<<6|s&63)):244>=p?u>=n-2?wt():(d=t[u++],(d&192)!==128||(p<<28)+(d-144)>>30||((s=t[u++])&192)!==128||((o=t[u++])&192)!==128?(u--,wt()):(p=(p&7)<<18|(d&63)<<12|(s&63)<<6|o&63,p-=65536,i.push((p>>10&1023)+55296,(p&1023)+56320))):wt(),8192<=i.length&&(l=Ce(l,i),i.length=0);u=Ce(l,i)}return ht(e,r,u),!0},function(t,e,r){if(e=ot(e,r),e!=null){var n=!1;if(n=n===void 0?!1:n,Pr){if(n&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(e))throw Error("Found an unpaired surrogate");e=(Fe||(Fe=new TextEncoder)).encode(e)}else{for(var i=0,s=new Uint8Array(3*e.length),o=0;o<e.length;o++){var u=e.charCodeAt(o);if(128>u)s[i++]=u;else{if(2048>u)s[i++]=u>>6|192;else{if(55296<=u&&57343>=u){if(56319>=u&&o<e.length){var l=e.charCodeAt(++o);if(56320<=l&&57343>=l){u=1024*(u-55296)+l-56320+65536,s[i++]=u>>18|240,s[i++]=u>>12&63|128,s[i++]=u>>6&63|128,s[i++]=u&63|128;continue}else o--}if(n)throw Error("Found an unpaired surrogate");u=65533}s[i++]=u>>12|224,s[i++]=u>>6&63|128}s[i++]=u&63|128}}e=i===s.length?s:s.subarray(0,i)}At(t.h,8*r+2),At(t.h,e.length),St(t,t.h.end()),St(t,e)}}),sr=Bt(function(t,e,r,n,i){if(t.i!==2)return!1;e=He(e,r,n),r=t.h.j,n=Mt(t.h)>>>0;var s=t.h.h+n,o=s-r;if(0>=o&&(t.h.j=s,i(e,t,void 0,void 0,void 0),o=s-t.h.h),o)throw Error("Message parsing ended unexpectedly. Expected to read "+(n+" bytes, instead read "+(n-o)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return t.h.h=s,t.h.j=r,!0},function(t,e,r,n,i){if(e=Ht(e,n,r),e!=null)for(n=0;n<e.length;n++){var s=t;At(s.h,8*r+2);var o=s.h.end();St(s,o),o.push(s.i),s=o,i(e[n],t),o=t;var u=s.pop();for(u=o.i+o.h.length()-u;127<u;)s.push(u&127|128),u>>>=7,o.i++;s.push(u),o.i++}});function ve(t){return function(e,r){t:{if(Nt.length){var n=Nt.pop();n.setOptions(r),re(n.h,e,r),e=n}else e=new ie(e,r);try{var i=pe(t),s=nr(new i.P,e,i);break t}finally{i=e.h,i.i=null,i.m=!1,i.l=0,i.j=0,i.h=0,i.S=!1,e.l=-1,e.i=-1,100>Nt.length&&Nt.push(e)}s=void 0}return s}}function de(t){return function(){var e=new Cr;ir(this,e,fe(t)),St(e,e.h.end());for(var r=new Uint8Array(e.i),n=e.j,i=n.length,s=0,o=0;o<i;o++){var u=n[o];r.set(u,s),s+=u.length}return e.j=[r],r}}function Pt(t){J.call(this,t)}g(Pt,J);var ur=[Pt,1,Vr,2,st,3,or,4,or];Pt.prototype.l=de(ur);function ye(t){J.call(this,t,-1,Yr)}g(ye,J),ye.prototype.addClassification=function(t,e){return He(this,1,Pt,t,e),this};var Yr=[1],lr=ve([ye,1,sr,ur]);function Tt(t){J.call(this,t)}g(Tt,J);var hr=[Tt,1,st,2,st,3,st,4,st,5,st];Tt.prototype.l=de(hr);function cr(t){J.call(this,t,-1,Kr)}g(cr,J);var Kr=[1],ar=ve([cr,1,sr,hr]);function Kt(t){J.call(this,t)}g(Kt,J);var fr=[Kt,1,st,2,st,3,st,4,st,5,st,6,Xr],$r=ve(fr);Kt.prototype.l=de(fr);function pr(t,e,r){if(r=t.createShader(r===0?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+t.getShaderInfoLog(r));return r}function vr(t){return Ht(t,Pt,1).map(function(e){var r=ot(e,1);return{index:r??0,score:at(e,2),label:ot(e,3)!=null?Wt(ot(e,3),""):void 0,displayName:ot(e,4)!=null?Wt(ot(e,4),""):void 0}})}function dr(t){return{x:at(t,1),y:at(t,2),z:at(t,3),visibility:ce(t,4)!=null?at(t,4):void 0}}function yr(t){return t.map(function(e){return Ht(ar(e),Tt,1).map(dr)})}function me(t,e){this.i=t,this.h=e,this.m=0}function mr(t,e,r){return Zr(t,e),typeof t.h.canvas.transferToImageBitmap=="function"?Promise.resolve(t.h.canvas.transferToImageBitmap()):r?Promise.resolve(t.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(t.h.canvas):(t.j===void 0&&(t.j=document.createElement("canvas")),new Promise(function(n){t.j.height=t.h.canvas.height,t.j.width=t.h.canvas.width,t.j.getContext("2d",{}).drawImage(t.h.canvas,0,0,t.h.canvas.width,t.h.canvas.height),n(t.j)}))}function Zr(t,e){var r=t.h;if(t.s===void 0){var n=pr(r,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),i=pr(r,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),s=r.createProgram();if(r.attachShader(s,n),r.attachShader(s,i),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+r.getProgramInfoLog(s));n=t.s=s,r.useProgram(n),i=r.getUniformLocation(n,"sampler0"),t.l={O:r.getAttribLocation(n,"aVertex"),N:r.getAttribLocation(n,"aTex"),xa:i},t.v=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,t.v),r.enableVertexAttribArray(t.l.O),r.vertexAttribPointer(t.l.O,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),t.u=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,t.u),r.enableVertexAttribArray(t.l.N),r.vertexAttribPointer(t.l.N,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.uniform1i(i,0)}n=t.l,r.useProgram(t.s),r.canvas.width=e.width,r.canvas.height=e.height,r.viewport(0,0,e.width,e.height),r.activeTexture(r.TEXTURE0),t.i.bindTexture2d(e.glName),r.enableVertexAttribArray(n.O),r.bindBuffer(r.ARRAY_BUFFER,t.v),r.vertexAttribPointer(n.O,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(n.N),r.bindBuffer(r.ARRAY_BUFFER,t.u),r.vertexAttribPointer(n.N,2,r.FLOAT,!1,0,0),r.bindFramebuffer(r.DRAW_FRAMEBUFFER?r.DRAW_FRAMEBUFFER:r.FRAMEBUFFER,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.colorMask(!0,!0,!0,!0),r.drawArrays(r.TRIANGLE_FAN,0,4),r.disableVertexAttribArray(n.O),r.disableVertexAttribArray(n.N),r.bindBuffer(r.ARRAY_BUFFER,null),t.i.bindTexture2d(0)}function Qr(t){this.h=t}var Jr=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function qr(t,e){return e+t}function gr(t,e){window[t]=e}function tn(t){var e=document.createElement("script");return e.setAttribute("src",t),e.setAttribute("crossorigin","anonymous"),new Promise(function(r){e.addEventListener("load",function(){r()},!1),e.addEventListener("error",function(){r()},!1),document.body.appendChild(e)})}function en(){return c(function(t){switch(t.h){case 1:return t.s=2,F(t,WebAssembly.instantiate(Jr),4);case 4:t.h=3,t.s=0;break;case 2:return t.s=0,t.l=null,t.return(!1);case 3:return t.return(!0)}})}function ge(t){if(this.h=t,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=t&&t.locateFile||qr,typeof window=="object")var e=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")e=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=e,t.options){e=M(Object.keys(t.options));for(var r=e.next();!r.done;r=e.next()){r=r.value;var n=t.options[r].default;n!==void 0&&(this.l[r]=typeof n=="function"?n():n)}}}G=ge.prototype,G.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function rn(t){var e,r,n,i,s,o,u,l,p,d,E;return c(function(b){switch(b.h){case 1:return t.ga?(e=t.h.files===void 0?[]:typeof t.h.files=="function"?t.h.files(t.l):t.h.files,F(b,en(),2)):b.return();case 2:if(r=b.i,typeof window=="object")return gr("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),gr("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),o=e.filter(function(y){return y.data!==void 0}),u=e.filter(function(y){return y.data===void 0}),l=Promise.all(o.map(function(y){var S=$t(t,y.url);if(y.path!==void 0){var _=y.path;S=S.then(function(D){return t.overrideFile(_,D),Promise.resolve(D)})}return S})),p=Promise.all(u.map(function(y){return y.simd===void 0||y.simd&&r||!y.simd&&!r?tn(t.locateFile(y.url,t.ha)):Promise.resolve()})).then(function(){var y,S,_;return c(function(D){if(D.h==1)return y=window.createMediapipeSolutionsWasm,S=window.createMediapipeSolutionsPackedAssets,_=t,F(D,y(S),2);_.i=D.i,D.h=0})}),d=function(){return c(function(y){return t.h.graph&&t.h.graph.url?y=F(y,$t(t,t.h.graph.url),0):(y.h=0,y=void 0),y})}(),F(b,Promise.all([p,l,d]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return n=e.filter(function(y){return y.simd===void 0||y.simd&&r||!y.simd&&!r}).map(function(y){return t.locateFile(y.url,t.ha)}),importScripts.apply(null,mt(n)),i=t,F(b,createMediapipeSolutionsWasm(Module),6);case 6:i.i=b.i,t.m=new OffscreenCanvas(1,1),t.i.canvas=t.m,s=t.i.GL.createContext(t.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),t.i.GL.makeContextCurrent(s),b.h=4;break;case 7:if(t.m=document.createElement("canvas"),E=t.m.getContext("webgl2",{}),!E&&(E=t.m.getContext("webgl",{}),!E))return alert("Failed to create WebGL canvas context when passing video frame."),b.return();t.K=E,t.i.canvas=t.m,t.i.createContext(t.m,!0,!0,{});case 4:t.j=new t.i.SolutionWasm,t.ga=!1,b.h=0}})}function nn(t){var e,r,n,i,s,o,u,l;return c(function(p){if(p.h==1){if(t.h.graph&&t.h.graph.url&&t.fa===t.h.graph.url)return p.return();if(t.u=!0,!t.h.graph||!t.h.graph.url){p.h=2;return}return t.fa=t.h.graph.url,F(p,$t(t,t.h.graph.url),3)}for(p.h!=2&&(e=p.i,t.j.loadGraph(e)),r=M(Object.keys(t.D)),n=r.next();!n.done;n=r.next())i=n.value,t.j.overrideFile(i,t.D[i]);if(t.D={},t.h.listeners)for(s=M(t.h.listeners),o=s.next();!o.done;o=s.next())u=o.value,ln(t,u);l=t.l,t.l={},t.setOptions(l),p.h=0})}G.reset=function(){var t=this;return c(function(e){t.j&&(t.j.reset(),t.s={},t.v={}),e.h=0})},G.setOptions=function(t,e){var r=this;if(e=e||this.h.options){for(var n=[],i=[],s={},o=M(Object.keys(t)),u=o.next();!u.done;s={X:s.X,Y:s.Y},u=o.next())if(u=u.value,!(u in this.l&&this.l[u]===t[u])){this.l[u]=t[u];var l=e[u];l!==void 0&&(l.onChange&&(s.X=l.onChange,s.Y=t[u],n.push(function(p){return function(){var d;return c(function(E){if(E.h==1)return F(E,p.X(p.Y),2);d=E.i,d===!0&&(r.u=!0),E.h=0})}}(s))),l.graphOptionXref&&(u=Object.assign({},{calculatorName:"",calculatorIndex:0},l.graphOptionXref,{valueNumber:l.type===1?t[u]:0,valueBoolean:l.type===0?t[u]:!1,valueString:l.type===2?t[u]:""}),i.push(u)))}(n.length!==0||i.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(i),this.F=(this.F===void 0?[]:this.F).concat(n))}};function on(t){var e,r,n,i,s,o,u;return c(function(l){switch(l.h){case 1:if(!t.u)return l.return();if(!t.F){l.h=2;break}e=M(t.F),r=e.next();case 3:if(r.done){l.h=5;break}return n=r.value,F(l,n(),4);case 4:r=e.next(),l.h=3;break;case 5:t.F=void 0;case 2:if(t.H){for(i=new t.i.GraphOptionChangeRequestList,s=M(t.H),o=s.next();!o.done;o=s.next())u=o.value,i.push_back(u);t.j.changeOptions(i),i.delete(),t.H=void 0}t.u=!1,l.h=0}})}G.initialize=function(){var t=this;return c(function(e){return e.h==1?F(e,rn(t),2):e.h!=3?F(e,nn(t),3):F(e,on(t),0)})};function $t(t,e){var r,n;return c(function(i){return e in t.L?i.return(t.L[e]):(r=t.locateFile(e,""),n=fetch(r).then(function(s){return s.arrayBuffer()}),t.L[e]=n,i.return(n))})}G.overrideFile=function(t,e){this.j?this.j.overrideFile(t,e):this.D[t]=e},G.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},G.send=function(t,e){var r=this,n,i,s,o,u,l,p,d,E;return c(function(b){switch(b.h){case 1:return r.h.inputs?(n=1e3*(e??performance.now()),F(b,r.I,2)):b.return();case 2:return F(b,r.initialize(),3);case 3:for(i=new r.i.PacketDataList,s=M(Object.keys(t)),o=s.next();!o.done;o=s.next())if(u=o.value,l=r.h.inputs[u]){t:{var y=t[u];switch(l.type){case"video":var S=r.s[l.stream];if(S||(S=new me(r.i,r.K),r.s[l.stream]=S),S.m===0&&(S.m=S.i.createTexture()),typeof HTMLVideoElement<"u"&&y instanceof HTMLVideoElement)var _=y.videoWidth,D=y.videoHeight;else typeof HTMLImageElement<"u"&&y instanceof HTMLImageElement?(_=y.naturalWidth,D=y.naturalHeight):(_=y.width,D=y.height);D={glName:S.m,width:_,height:D},_=S.h,_.canvas.width=D.width,_.canvas.height=D.height,_.activeTexture(_.TEXTURE0),S.i.bindTexture2d(S.m),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,y),S.i.bindTexture2d(0),S=D;break t;case"detections":for(S=r.s[l.stream],S||(S=new Qr(r.i),r.s[l.stream]=S),S.data||(S.data=new S.h.DetectionListData),S.data.reset(y.length),D=0;D<y.length;++D){_=y[D];var I=S.data,Y=I.setBoundingBox,rt=D,q=_.la,R=new Kt;if(ct(R,1,q.ra),ct(R,2,q.sa),ct(R,3,q.height),ct(R,4,q.width),ct(R,5,q.rotation),ht(R,6,q.pa),q=R.l(),Y.call(I,rt,q),_.ea)for(I=0;I<_.ea.length;++I){R=_.ea[I],Y=S.data,rt=Y.addNormalizedLandmark,q=D,R=Object.assign({},R,{visibility:R.visibility?R.visibility:0});var K=new Tt;ct(K,1,R.x),ct(K,2,R.y),ct(K,3,R.z),R.visibility&&ct(K,4,R.visibility),R=K.l(),rt.call(Y,q,R)}if(_.ba)for(I=0;I<_.ba.length;++I)Y=S.data,rt=Y.addClassification,q=D,R=_.ba[I],K=new Pt,ct(K,2,R.score),R.index&&ht(K,1,R.index),R.label&&ht(K,3,R.label),R.displayName&&ht(K,4,R.displayName),R=K.l(),rt.call(Y,q,R)}S=S.data;break t;default:S={}}}switch(p=S,d=l.stream,l.type){case"video":i.pushTexture2d(Object.assign({},p,{stream:d,timestamp:n}));break;case"detections":E=p,E.stream=d,E.timestamp=n,i.pushDetectionList(E);break;default:throw Error("Unknown input config type: '"+l.type+"'")}}return r.j.send(i),F(b,r.I,4);case 4:i.delete(),b.h=0}})};function sn(t,e,r){var n,i,s,o,u,l,p,d,E,b,y,S,_,D;return c(function(I){switch(I.h){case 1:if(!r)return I.return(e);for(n={},i=0,s=M(Object.keys(r)),o=s.next();!o.done;o=s.next())u=o.value,l=r[u],typeof l!="string"&&l.type==="texture"&&e[l.stream]!==void 0&&++i;1<i&&(t.M=!1),p=M(Object.keys(r)),o=p.next();case 2:if(o.done){I.h=4;break}if(d=o.value,E=r[d],typeof E=="string")return _=n,D=d,F(I,un(t,d,e[E]),14);if(b=e[E.stream],E.type==="detection_list"){if(b){for(var Y=b.getRectList(),rt=b.getLandmarksList(),q=b.getClassificationsList(),R=[],K=0;K<Y.size();++K){var gt=$r(Y.get(K)),hn=at(gt,1),cn=at(gt,2),an=at(gt,3),fn=at(gt,4),pn=at(gt,5,0),Zt=void 0;Zt=Zt===void 0?0:Zt,gt={la:{ra:hn,sa:cn,height:an,width:fn,rotation:pn,pa:Wt(ot(gt,6),Zt)},ea:Ht(ar(rt.get(K)),Tt,1).map(dr),ba:vr(lr(q.get(K)))},R.push(gt)}Y=R}else Y=[];n[d]=Y,I.h=7;break}if(E.type==="proto_list"){if(b){for(Y=Array(b.size()),rt=0;rt<b.size();rt++)Y[rt]=b.get(rt);b.delete()}else Y=[];n[d]=Y,I.h=7;break}if(b===void 0){I.h=3;break}if(E.type==="float_list"){n[d]=b,I.h=7;break}if(E.type==="proto"){n[d]=b,I.h=7;break}if(E.type!=="texture")throw Error("Unknown output config type: '"+E.type+"'");return y=t.v[d],y||(y=new me(t.i,t.K),t.v[d]=y),F(I,mr(y,b,t.M),13);case 13:S=I.i,n[d]=S;case 7:E.transform&&n[d]&&(n[d]=E.transform(n[d])),I.h=3;break;case 14:_[D]=I.i;case 3:o=p.next(),I.h=2;break;case 4:return I.return(n)}})}function un(t,e,r){var n;return c(function(i){return typeof r=="number"||r instanceof Uint8Array||r instanceof t.i.Uint8BlobList?i.return(r):r instanceof t.i.Texture2dDataOut?(n=t.v[e],n||(n=new me(t.i,t.K),t.v[e]=n),i.return(mr(n,r,t.M))):i.return(void 0)})}function ln(t,e){for(var r=e.name||"$",n=[].concat(mt(e.wants)),i=new t.i.StringList,s=M(e.wants),o=s.next();!o.done;o=s.next())i.push_back(o.value);s=t.i.PacketListener.implement({onResults:function(u){for(var l={},p=0;p<e.wants.length;++p)l[n[p]]=u.get(p);var d=t.listeners[r];d&&(t.I=sn(t,l,e.outs).then(function(E){E=d(E);for(var b=0;b<e.wants.length;++b){var y=l[n[b]];typeof y=="object"&&y.hasOwnProperty&&y.hasOwnProperty("delete")&&y.delete()}E&&(t.I=E)}))}}),t.j.attachMultiListener(i,s),i.delete()}G.onResults=function(t,e){this.listeners[e||"$"]=t},H("Solution",ge),H("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function wr(t){return t===void 0&&(t=0),t===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function xr(t){var e=this;t=t||{},this.h=new ge({locateFile:t.locateFile,files:function(r){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:wr(r.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:yr},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:yr},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(r){return r.map(function(n){return vr(lr(n))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(r){var n,i,s;return c(function(o){return o.h==1?(n=wr(r),i="third_party/mediapipe/modules/hand_landmark/"+n,F(o,$t(e.h,n),2)):(s=o.i,e.h.overrideFile(i,s),o.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}G=xr.prototype,G.close=function(){return this.h.close(),Promise.resolve()},G.onResults=function(t){this.h.onResults(t)},G.initialize=function(){var t=this;return c(function(e){return F(e,t.h.initialize(),0)})},G.reset=function(){this.h.reset()},G.send=function(t){var e=this;return c(function(r){return F(r,e.h.send(t),0)})},G.setOptions=function(t){this.h.setOptions(t)},H("Hands",xr),H("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),H("VERSION","0.4.1675469240")}).call(yt);var dn={};(function(){function G(h){var c=0;return function(){return c<h.length?{done:!1,value:h[c++]}:{done:!0}}}var a=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,c,T){return h==Array.prototype||h==Object.prototype||(h[c]=T.value),h};function m(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof yt=="object"&&yt];for(var c=0;c<h.length;++c){var T=h[c];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var P=m(this);function w(h,c){if(c)t:{var T=P;h=h.split(".");for(var j=0;j<h.length-1;j++){var L=h[j];if(!(L in T))break t;T=T[L]}h=h[h.length-1],j=T[h],c=c(j),c!=j&&c!=null&&a(T,h,{configurable:!0,writable:!0,value:c})}}w("Symbol",function(h){function c(H){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new T(j+(H||"")+"_"+L++,H)}function T(H,v){this.g=H,a(this,"description",{configurable:!0,writable:!0,value:v})}if(h)return h;T.prototype.toString=function(){return this.g};var j="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",L=0;return c}),w("Symbol.iterator",function(h){if(h)return h;h=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),T=0;T<c.length;T++){var j=P[c[T]];typeof j=="function"&&typeof j.prototype[h]!="function"&&a(j.prototype,h,{configurable:!0,writable:!0,value:function(){return C(G(this))}})}return h});function C(h){return h={next:h},h[Symbol.iterator]=function(){return this},h}function X(h){var c=typeof Symbol<"u"&&Symbol.iterator&&h[Symbol.iterator];return c?c.call(h):{next:G(h)}}function M(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function mt(h){if(h.i)throw new TypeError("Generator is already running");h.i=!0}M.prototype.l=function(h){this.o=h};function nt(h,c){h.h={F:c,G:!0},h.j=h.m}M.prototype.return=function(h){this.h={return:h},this.j=this.m};function jt(h){this.g=new M,this.h=h}function ft(h,c){mt(h.g);var T=h.g.g;return T?V(h,"return"in T?T.return:function(j){return{value:j,done:!0}},c,h.g.return):(h.g.return(c),ut(h))}function V(h,c,T,j){try{var L=c.call(h.g.g,T);if(!(L instanceof Object))throw new TypeError("Iterator result "+L+" is not an object");if(!L.done)return h.g.i=!1,L;var H=L.value}catch(v){return h.g.g=null,nt(h.g,v),ut(h)}return h.g.g=null,j.call(h.g,H),ut(h)}function ut(h){for(;h.g.j;)try{var c=h.h(h.g);if(c)return h.g.i=!1,{value:c.value,done:!1}}catch(T){h.g.o=void 0,nt(h.g,T)}if(h.g.i=!1,h.g.h){if(c=h.g.h,h.g.h=null,c.G)throw c.F;return{value:c.return,done:!0}}return{value:void 0,done:!0}}function f(h){this.next=function(c){return mt(h.g),h.g.g?c=V(h,h.g.g.next,c,h.g.l):(h.g.l(c),c=ut(h)),c},this.throw=function(c){return mt(h.g),h.g.g?c=V(h,h.g.g.throw,c,h.g.l):(nt(h.g,c),c=ut(h)),c},this.return=function(c){return ft(h,c)},this[Symbol.iterator]=function(){return this}}function x(h){function c(j){return h.next(j)}function T(j){return h.throw(j)}return new Promise(function(j,L){function H(v){v.done?j(v.value):Promise.resolve(v.value).then(c,T).then(H,L)}H(h.next())})}w("Promise",function(h){function c(v){this.h=0,this.i=void 0,this.g=[],this.o=!1;var O=this.j();try{v(O.resolve,O.reject)}catch(k){O.reject(k)}}function T(){this.g=null}function j(v){return v instanceof c?v:new c(function(O){O(v)})}if(h)return h;T.prototype.h=function(v){if(this.g==null){this.g=[];var O=this;this.i(function(){O.l()})}this.g.push(v)};var L=P.setTimeout;T.prototype.i=function(v){L(v,0)},T.prototype.l=function(){for(;this.g&&this.g.length;){var v=this.g;this.g=[];for(var O=0;O<v.length;++O){var k=v[O];v[O]=null;try{k()}catch(N){this.j(N)}}}this.g=null},T.prototype.j=function(v){this.i(function(){throw v})},c.prototype.j=function(){function v(N){return function(tt){k||(k=!0,N.call(O,tt))}}var O=this,k=!1;return{resolve:v(this.A),reject:v(this.l)}},c.prototype.A=function(v){if(v===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(v instanceof c)this.C(v);else{t:switch(typeof v){case"object":var O=v!=null;break t;case"function":O=!0;break t;default:O=!1}O?this.v(v):this.m(v)}},c.prototype.v=function(v){var O=void 0;try{O=v.then}catch(k){this.l(k);return}typeof O=="function"?this.D(O,v):this.m(v)},c.prototype.l=function(v){this.u(2,v)},c.prototype.m=function(v){this.u(1,v)},c.prototype.u=function(v,O){if(this.h!=0)throw Error("Cannot settle("+v+", "+O+"): Promise already settled in state"+this.h);this.h=v,this.i=O,this.h===2&&this.B(),this.H()},c.prototype.B=function(){var v=this;L(function(){if(v.I()){var O=P.console;typeof O<"u"&&O.error(v.i)}},1)},c.prototype.I=function(){if(this.o)return!1;var v=P.CustomEvent,O=P.Event,k=P.dispatchEvent;return typeof k>"u"?!0:(typeof v=="function"?v=new v("unhandledrejection",{cancelable:!0}):typeof O=="function"?v=new O("unhandledrejection",{cancelable:!0}):(v=P.document.createEvent("CustomEvent"),v.initCustomEvent("unhandledrejection",!1,!0,v)),v.promise=this,v.reason=this.i,k(v))},c.prototype.H=function(){if(this.g!=null){for(var v=0;v<this.g.length;++v)H.h(this.g[v]);this.g=null}};var H=new T;return c.prototype.C=function(v){var O=this.j();v.s(O.resolve,O.reject)},c.prototype.D=function(v,O){var k=this.j();try{v.call(O,k.resolve,k.reject)}catch(N){k.reject(N)}},c.prototype.then=function(v,O){function k(et,it){return typeof et=="function"?function(Ot){try{N(et(Ot))}catch(Et){tt(Et)}}:it}var N,tt,Ct=new c(function(et,it){N=et,tt=it});return this.s(k(v,N),k(O,tt)),Ct},c.prototype.catch=function(v){return this.then(void 0,v)},c.prototype.s=function(v,O){function k(){switch(N.h){case 1:v(N.i);break;case 2:O(N.i);break;default:throw Error("Unexpected state: "+N.h)}}var N=this;this.g==null?H.h(k):this.g.push(k),this.o=!0},c.resolve=j,c.reject=function(v){return new c(function(O,k){k(v)})},c.race=function(v){return new c(function(O,k){for(var N=X(v),tt=N.next();!tt.done;tt=N.next())j(tt.value).s(O,k)})},c.all=function(v){var O=X(v),k=O.next();return k.done?j([]):new c(function(N,tt){function Ct(Ot){return function(Et){et[Ot]=Et,it--,it==0&&N(et)}}var et=[],it=0;do et.push(void 0),it++,j(k.value).s(Ct(et.length-1),tt),k=O.next();while(!k.done)})},c});var g=typeof Object.assign=="function"?Object.assign:function(h,c){for(var T=1;T<arguments.length;T++){var j=arguments[T];if(j)for(var L in j)Object.prototype.hasOwnProperty.call(j,L)&&(h[L]=j[L])}return h};w("Object.assign",function(h){return h||g});var A=this||self,U={facingMode:"user",width:640,height:480};function B(h,c){this.video=h,this.i=0,this.h=Object.assign(Object.assign({},U),c)}B.prototype.stop=function(){var h=this,c,T,j,L;return x(new f(new jt(function(H){if(h.g){for(c=h.g.getTracks(),T=X(c),j=T.next();!j.done;j=T.next())L=j.value,L.stop();h.g=void 0}H.j=0})))},B.prototype.start=function(){var h=this,c;return x(new f(new jt(function(T){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),c=h.h,T.return(navigator.mediaDevices.getUserMedia({video:{facingMode:c.facingMode,width:c.width,height:c.height}}).then(function(j){Q(h,j)}).catch(function(j){var L="Failed to acquire camera feed: "+j;throw console.error(L),alert(L),j}))})))};function F(h){window.requestAnimationFrame(function(){Qt(h)})}function Q(h,c){h.g=c,h.video.srcObject=c,h.video.onloadedmetadata=function(){h.video.play(),F(h)}}function Qt(h){var c=null;h.video.paused||h.video.currentTime===h.i||(h.i=h.video.currentTime,c=h.h.onFrame()),c?c.then(function(){F(h)}):F(h)}var pt=["Camera"],$=A;pt[0]in $||typeof $.execScript>"u"||$.execScript("var "+pt[0]);for(var vt;pt.length&&(vt=pt.shift());)pt.length||B===void 0?$[vt]&&$[vt]!==Object.prototype[vt]?$=$[vt]:$=$[vt]={}:$[vt]=B}).call(yt);var br={};(function(){function G(f){var x=0;return function(){return x<f.length?{done:!1,value:f[x++]}:{done:!0}}}var a=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,x,g){return f==Array.prototype||f==Object.prototype||(f[x]=g.value),f};function m(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof yt=="object"&&yt];for(var x=0;x<f.length;++x){var g=f[x];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var P=m(this);function w(f,x){if(x)t:{var g=P;f=f.split(".");for(var A=0;A<f.length-1;A++){var U=f[A];if(!(U in g))break t;g=g[U]}f=f[f.length-1],A=g[f],x=x(A),x!=A&&x!=null&&a(g,f,{configurable:!0,writable:!0,value:x})}}function C(f){var x=typeof Symbol<"u"&&Symbol.iterator&&f[Symbol.iterator];return x?x.call(f):{next:G(f)}}var X=typeof Object.assign=="function"?Object.assign:function(f,x){for(var g=1;g<arguments.length;g++){var A=arguments[g];if(A)for(var U in A)Object.prototype.hasOwnProperty.call(A,U)&&(f[U]=A[U])}return f};w("Object.assign",function(f){return f||X}),w("Array.prototype.fill",function(f){return f||function(x,g,A){var U=this.length||0;for(0>g&&(g=Math.max(0,U+g)),(A==null||A>U)&&(A=U),A=Number(A),0>A&&(A=Math.max(0,U+A)),g=Number(g||0);g<A;g++)this[g]=x;return this}});function M(f){return f||Array.prototype.fill}w("Int8Array.prototype.fill",M),w("Uint8Array.prototype.fill",M),w("Uint8ClampedArray.prototype.fill",M),w("Int16Array.prototype.fill",M),w("Uint16Array.prototype.fill",M),w("Int32Array.prototype.fill",M),w("Uint32Array.prototype.fill",M),w("Float32Array.prototype.fill",M),w("Float64Array.prototype.fill",M);var mt=this||self;function nt(f,x){f=f.split(".");var g=mt;f[0]in g||typeof g.execScript>"u"||g.execScript("var "+f[0]);for(var A;f.length&&(A=f.shift());)f.length||x===void 0?g[A]&&g[A]!==Object.prototype[A]?g=g[A]:g=g[A]={}:g[A]=x}var jt={color:"white",lineWidth:4,radius:6,visibilityMin:.5};function ft(f){return f=f||{},Object.assign({},jt,{fillColor:f.color},f)}function V(f,x){return f instanceof Function?f(x):f}function ut(f,x,g){return Math.max(Math.min(x,g),Math.min(Math.max(x,g),f))}nt("clamp",ut),nt("drawLandmarks",function(f,x,g){if(x){g=ft(g),f.save();var A=f.canvas,U=0;x=C(x);for(var B=x.next();!B.done;B=x.next())if(B=B.value,B!==void 0&&(B.visibility===void 0||B.visibility>g.visibilityMin)){f.fillStyle=V(g.fillColor,{index:U,from:B}),f.strokeStyle=V(g.color,{index:U,from:B}),f.lineWidth=V(g.lineWidth,{index:U,from:B});var F=new Path2D;F.arc(B.x*A.width,B.y*A.height,V(g.radius,{index:U,from:B}),0,2*Math.PI),f.fill(F),f.stroke(F),++U}f.restore()}}),nt("drawConnectors",function(f,x,g,A){if(x&&g){A=ft(A),f.save();var U=f.canvas,B=0;g=C(g);for(var F=g.next();!F.done;F=g.next()){var Q=F.value;f.beginPath(),F=x[Q[0]],Q=x[Q[1]],F&&Q&&(F.visibility===void 0||F.visibility>A.visibilityMin)&&(Q.visibility===void 0||Q.visibility>A.visibilityMin)&&(f.strokeStyle=V(A.color,{index:B,from:F,to:Q}),f.lineWidth=V(A.lineWidth,{index:B,from:F,to:Q}),f.moveTo(F.x*U.width,F.y*U.height),f.lineTo(Q.x*U.width,Q.y*U.height)),++B,f.stroke()}f.restore()}}),nt("drawRectangle",function(f,x,g){g=ft(g),f.save();var A=f.canvas;f.beginPath(),f.lineWidth=V(g.lineWidth,{}),f.strokeStyle=V(g.color,{}),f.fillStyle=V(g.fillColor,{}),f.translate(x.xCenter*A.width,x.yCenter*A.height),f.rotate(x.rotation*Math.PI/180),f.rect(-x.width/2*A.width,-x.height/2*A.height,x.width*A.width,x.height*A.height),f.translate(-x.xCenter*A.width,-x.yCenter*A.height),f.stroke(),f.fill(),f.restore()}),nt("lerp",function(f,x,g,A,U){return ut(A*(1-(f-x)/(g-x))+U*(1-(g-f)/(g-x)),A,U)})}).call(yt);class yn{constructor(a,m){this.video=a,this.canvas=m,this.ctx=m.getContext("2d"),this.gestureCallback=null,this.lastGesture=null,this.gestureStartTime=0,this.gestureThreshold=300,this.hands=null,this.camera=null}async initialize(){this.hands=new Ar.Hands({locateFile:a=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${a}`}),this.hands.setOptions({maxNumHands:1,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),this.hands.onResults(a=>this.onResults(a)),this.camera=new dn.Camera(this.video,{onFrame:async()=>{await this.hands.send({image:this.video})},width:640,height:480}),await this.camera.start(),this.canvas.width=640,this.canvas.height=480}onResults(a){if(this.ctx.save(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(a.image,0,0,this.canvas.width,this.canvas.height),a.multiHandLandmarks&&a.multiHandLandmarks.length>0){const m=a.multiHandLandmarks[0];br.drawConnectors(this.ctx,m,Ar.HAND_CONNECTIONS,{color:"#00FF00",lineWidth:5}),br.drawLandmarks(this.ctx,m,{color:"#FF0000",lineWidth:2});const P=this.recognizeGesture(m);this.handleGesture(P),document.getElementById("hand-status").textContent="検出中",document.getElementById("gesture-type").textContent=P||"-"}else document.getElementById("hand-status").textContent="未検出",document.getElementById("gesture-type").textContent="-";this.ctx.restore()}recognizeGesture(a){const m=a[0],P=a[9],w=Math.atan2(P.y-m.y,P.x-m.x)*180/Math.PI,C=a[8],X=a[5];return C.y<X.y-.1&&this.isOnlyIndexExtended(a)?"rotate":w<-30?"right":w>30?"left":m.y<P.y-.1?"down":null}isOnlyIndexExtended(a){const P=[{tip:4,base:2},{tip:8,base:5},{tip:12,base:9},{tip:16,base:13},{tip:20,base:17}].map((w,C)=>C===0?Math.abs(a[w.tip].x-a[w.base].x)>.1:a[w.tip].y<a[w.base].y-.05);return P[1]&&!P[2]&&!P[3]&&!P[4]}handleGesture(a){if(!a){this.lastGesture=null,this.gestureStartTime=0;return}const m=Date.now();a!==this.lastGesture?(this.lastGesture=a,this.gestureStartTime=m):m-this.gestureStartTime>this.gestureThreshold&&this.gestureCallback&&this.gestureCallback(a)}onGesture(a){this.gestureCallback=a}}class mn{constructor(){this.tetrisCanvas=document.getElementById("tetris-canvas"),this.cameraVideo=document.getElementById("camera-video"),this.cameraCanvas=document.getElementById("camera-canvas"),this.startBtn=document.getElementById("start-btn"),this.pauseBtn=document.getElementById("pause-btn"),this.tetrisGame=new vn(this.tetrisCanvas),this.handTracker=new yn(this.cameraVideo,this.cameraCanvas),this.isPlaying=!1,this.isPaused=!1,this.setupEventListeners()}setupEventListeners(){this.startBtn.addEventListener("click",()=>this.startGame()),this.pauseBtn.addEventListener("click",()=>this.togglePause()),this.handTracker.onGesture(a=>{if(!(!this.isPlaying||this.isPaused))switch(a){case"left":this.tetrisGame.moveLeft();break;case"right":this.tetrisGame.moveRight();break;case"down":this.tetrisGame.softDrop();break;case"rotate":this.tetrisGame.rotate();break}}),document.addEventListener("keydown",a=>{if(!(!this.isPlaying||this.isPaused))switch(a.key){case"ArrowLeft":this.tetrisGame.moveLeft();break;case"ArrowRight":this.tetrisGame.moveRight();break;case"ArrowDown":this.tetrisGame.softDrop();break;case"ArrowUp":case" ":this.tetrisGame.rotate();break}})}async startGame(){try{await this.handTracker.initialize(),this.tetrisGame.start(),this.isPlaying=!0,this.startBtn.disabled=!0,this.pauseBtn.disabled=!1,this.gameLoop()}catch(a){console.error("ゲーム開始エラー:",a),alert("カメラの初期化に失敗しました。カメラのアクセス許可を確認してください。")}}togglePause(){this.isPaused=!this.isPaused,this.pauseBtn.textContent=this.isPaused?"再開":"一時停止",this.isPaused?this.tetrisGame.pause():(this.tetrisGame.resume(),this.gameLoop())}gameLoop(){if(!(!this.isPlaying||this.isPaused)){if(this.tetrisGame.update(),this.tetrisGame.render(),document.getElementById("score").textContent=this.tetrisGame.score,document.getElementById("lines").textContent=this.tetrisGame.lines,this.tetrisGame.isGameOver){this.gameOver();return}requestAnimationFrame(()=>this.gameLoop())}}gameOver(){this.isPlaying=!1,this.startBtn.disabled=!1,this.startBtn.textContent="もう一度プレイ",this.pauseBtn.disabled=!0,alert(`ゲームオーバー!
スコア: ${this.tetrisGame.score}
ライン: ${this.tetrisGame.lines}`)}}document.addEventListener("DOMContentLoaded",()=>{new mn});
